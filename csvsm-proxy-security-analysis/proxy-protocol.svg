<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 865 828" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="proxy-protocol" x="0.301" y="-0" width="864.429" height="827.667" style="fill:none;"/><rect x="418.757" y="737.376" width="312.32" height="40.771" style="fill:none;stroke:#ff6b00;stroke-width:2px;"/><rect x="417.91" y="139.709" width="313.167" height="60.291" style="fill:none;stroke:#ff6b00;stroke-width:2px;"/><rect x="133.103" y="239.709" width="285.807" height="460.291" style="fill:none;stroke:#ff6b00;stroke-width:2px;"/><g transform="matrix(12,0,0,12,320.372,230.685)"></g><text x="150.479px" y="230.685px" style="font-family:'Tahoma';font-size:12px;fill:#ff6b00;">T<tspan x="156.374px 160.698px " y="230.685px 230.685px ">ru</tspan>stee KBS attestation protocol</text><use xlink:href="#_Image1" x="721.41" y="45.625" width="5px" height="754px"/><use xlink:href="#_Image1" x="423.27" y="45.625" width="5px" height="754px"/><rect x="432.437" y="239.709" width="285.807" height="460.291" style="fill:none;stroke:#ff6b00;stroke-width:2px;"/><rect x="712.244" y="258.627" width="23.333" height="425.61" style="fill:#bcbcbc;"/><rect x="414.103" y="258.627" width="23.333" height="425.61" style="fill:#bcbcbc;"/><use xlink:href="#_Image1" x="135.27" y="45.625" width="5px" height="754px"/><g transform="matrix(14,0,0,14,180.662,38.328)"></g><text x="95.09px" y="38.328px" style="font-family:'Tahoma-Bold', 'Tahoma';font-weight:700;font-size:14px;">Trustee KBS</text><g transform="matrix(14,0,0,14,463.973,38.328)"></g><text x="387.779px" y="38.328px" style="font-family:'Tahoma-Bold', 'Tahoma';font-weight:700;font-size:14px;">Hypervisor</text><g transform="matrix(14,0,0,14,743.858,38.328)"></g><text x="704.175px" y="38.328px" style="font-family:'Tahoma-Bold', 'Tahoma';font-weight:700;font-size:14px;">SVSM</text><g transform="matrix(12,0,0,12,688.977,498.352)"></g><text x="461.007px" y="498.352px" style="font-family:'Tahoma';font-size:12px;fill:#6d6d6d;">(w/ nonce and svsm_pk included in report)</text><g transform="matrix(12,0,0,12,635.134,185.352)"></g><text x="514.771px" y="185.352px" style="font-family:'Tahoma';font-size:12px;fill:#6d6d6d;">on virtio disk or similar</text><g transform="matrix(12,0,0,12,602.652,267.352)"></g><text x="546.162px" y="267.352px" style="font-family:'Tahoma';font-size:12px;">2. R<tspan x="567.326px 573.642px " y="267.352px 267.352px ">eq</tspan>uest</text><use xlink:href="#_Image2" x="434.77" y="269.125" width="282px" height="11px"/><g transform="matrix(12,0,0,12,624.316,473.685)"></g><text x="525.006px" y="473.685px" style="font-family:'Tahoma';font-size:12px;">8. svsm_pk, report</text><use xlink:href="#_Image2" x="434.91" y="475.459" width="282px" height="11px"/><g transform="matrix(12,0,0,12,326.176,500.352)"></g><text x="226.866px" y="500.352px" style="font-family:'Tahoma';font-size:12px;">9. svsm_pk, report</text><use xlink:href="#_Image3" x="136.77" y="502.125" width="282px" height="11px"/><g transform="matrix(12,0,0,12,597.539,350.352)"></g><text x="551.853px" y="350.352px" style="font-family:'Tahoma';font-size:12px;">5. nonce</text><use xlink:href="#_Image4" x="433.41" y="352.125" width="282px" height="11px"/><g transform="matrix(12,0,0,12,601.249,161.352)"></g><text x="548.451px" y="161.352px" style="font-family:'Tahoma';font-size:12px;">1. e_state</text><g transform="matrix(1,0,0,1,462.517,-636.743)"><text x="-21.371px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#ff6b00;">Frontend pro<tspan x="47.073px 53.014px " y="867.429px 867.429px ">xy</tspan> protocol</text><g transform="matrix(12,0,0,12,246.766,867.429)"></g><text x="109.229px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#6d6d6d;">(common to all back<tspan x="217.176px 223.493px " y="867.429px 867.429px ">en</tspan>ds)</text></g><g transform="matrix(1,0,0,1,462.517,-736.743)"><text x="-21.371px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#ff6b00;">State stor<tspan x="29.711px 36.01px " y="867.429px 867.429px ">ag</tspan>e provider</text><g transform="matrix(12,0,0,12,248.823,867.429)"></g><text x="99.795px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#6d6d6d;">(not currently implemented)</text></g><g transform="matrix(1,0,0,1,463.363,-139.077)"><text x="-21.371px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#ff6b00;">State stor<tspan x="29.711px 36.01px " y="867.429px 867.429px ">ag</tspan>e provider</text><g transform="matrix(12,0,0,12,248.823,867.429)"></g><text x="99.795px" y="867.429px" style="font-family:'Tahoma';font-size:12px;fill:#6d6d6d;">(not currently implemented)</text></g><use xlink:href="#_Image5" x="423.27" y="163.125" width="303px" height="11px"/><rect x="632.175" y="376.553" width="181.445" height="33.594" style="fill:#ebebeb;"/><rect x="605.585" y="420.886" width="236.112" height="33.594" style="fill:#ebebeb;"/><rect x="609.653" y="651.411" width="228.076" height="22.594" style="fill:#ebebeb;"/><g transform="matrix(1,0,0,1,665.408,-201.394)"><text x="-52.822px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">14<tspan x="-39.838px -36.205px " y="867.429px 867.429px ">. </tspan>state_k<tspan x="5.965px 12.281px " y="867.429px 867.429px ">ey</tspan> := Dec</text><text x="58.723px" y="870.429px" style="font-family:'Tahoma';font-size:10px;">svsm_sk</text><g transform="matrix(12,0,0,12,168.697,867.429)"></g><text x="95.93px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">(e_state_k<tspan x="151.81px 158.127px " y="867.429px 867.429px ">ey</tspan>)</text></g><g transform="matrix(12,0,0,12,305.144,290.685)"></g><text x="248.654px" y="290.685px" style="font-family:'Tahoma';font-size:12px;">3. R<tspan x="269.818px 276.134px " y="290.685px 290.685px ">eq</tspan>uest</text><use xlink:href="#_Image3" x="137.262" y="292.459" width="282px" height="11px"/><g transform="matrix(12,0,0,12,299.384,322.685)"></g><text x="253.816px" y="322.685px" style="font-family:'Tahoma';font-size:12px;">4<tspan x="260.249px 263.882px " y="322.685px 322.685px ">. </tspan>nonce</text><use xlink:href="#_Image6" x="135.27" y="324.459" width="282px" height="11px"/><g transform="matrix(12,0,0,12,320.507,599.685)"></g><text x="236.443px" y="599.685px" style="font-family:'Tahoma';font-size:12px;">12. e_state_k<tspan x="308.214px 314.531px " y="599.685px 599.685px ">ey</tspan></text><use xlink:href="#_Image6" x="135.27" y="603.459" width="282px" height="11px"/><g transform="matrix(12,0,0,12,618.659,621.685)"></g><text x="534.595px" y="621.685px" style="font-family:'Tahoma';font-size:12px;">13. e_state_k<tspan x="606.366px 612.683px " y="621.685px 621.685px ">ey</tspan></text><use xlink:href="#_Image4" x="433.422" y="625.459" width="282px" height="11px"/><g transform="matrix(6.12323e-17,-1,1,6.12323e-17,-866.298,-8.25726)"><g transform="matrix(12,0,0,12,-277.993,1296.45)"></g><text x="-465.077px" y="1296.45px" style="font-family:'Tahoma-Bold', 'Tahoma';font-weight:700;font-size:12px;">Proxy Backend for Trustee KBS</text></g><g transform="matrix(6.12323e-17,-1,1,6.12323e-17,-534.257,256.155)"><g transform="matrix(12,0,0,12,-13.065,1262.63)"></g><text x="-105.848px" y="1262.63px" style="font-family:'Tahoma-Bold', 'Tahoma';font-weight:700;font-size:12px;">Proxy Frontend</text></g><rect x="73.103" y="69.321" width="129.333" height="33.6" style="fill:#ebebeb;"/><g transform="matrix(1,0,0,1,79.9529,-783.739)"><text x="1.816px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">Pre-provisioned with:</text><g transform="matrix(12,0,0,12,83.2938,879.429)"></g><text x="32.581px" y="879.429px" style="font-family:'Tahoma';font-size:12px;">state_k<tspan x="71.001px 77.317px " y="879.429px 879.429px ">ey</tspan></text></g><rect x="331.77" y="69.294" width="189.333" height="33.6" style="fill:#ebebeb;"/><g transform="matrix(1,0,0,1,368.286,-784.739)"><text x="1.816px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">Pre-provisioned with:</text><text x="-32.715px" y="881.429px" style="font-family:'Tahoma';font-size:12px;">e_state</text><text x="9.9px" y="881.429px" style="font-family:'Tahoma';font-size:14px;">←</text><text x="27.65px" y="881.429px" style="font-family:'Tahoma';font-size:12px;">AuthEnc</text><text x="71.144px" y="884.429px" style="font-family:'Tahoma';font-size:10px;">state_key</text><g transform="matrix(12,0,0,12,148.59,881.429)"></g><text x="113.405px" y="881.429px" style="font-family:'Tahoma';font-size:12px;">(state)</text></g><g transform="matrix(1,0,0,1,664.909,-476.728)"><text x="-28.456px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">6. Gener<tspan x="16.931px 23.229px " y="867.429px 867.429px ">at</tspan>es ephemer<tspan x="89.136px 95.434px " y="867.429px 867.429px ">al</tspan> k<tspan x="107.798px 114.114px " y="867.429px 867.429px ">ey</tspan>pair:</text><g transform="matrix(12,0,0,12,111.814,879.429)"></g><text x="4.06px" y="879.429px" style="font-family:'Tahoma';font-size:12px;">(svsm_pk; svsm_sk)</text></g><rect x="23.175" y="523.553" width="231.445" height="23.6" style="fill:#ebebeb;"/><g transform="matrix(12,0,0,12,248.757,538.701)"></g><text x="29.177px" y="538.701px" style="font-family:'Tahoma';font-size:12px;">10. Authenticates svsm_pk against report</text><rect x="21.822" y="555.553" width="231.204" height="23.594" style="fill:#ebebeb;"/><g transform="matrix(1,0,0,1,79.9092,-296.728)"><text x="-53.411px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">11. e_state_k<tspan x="18.36px 24.677px " y="867.429px 867.429px ">ey</tspan></text><text x="34.403px" y="867.429px" style="font-family:'Tahoma';font-size:14px;">←</text><text x="52.153px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">Enc</text><text x="71.114px" y="870.429px" style="font-family:'Tahoma';font-size:10px;">svsm_pk</text><g transform="matrix(12,0,0,12,173.036,867.429)"></g><text x="109.386px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">(state_k<tspan x="152.399px 158.716px " y="867.429px 867.429px ">ey</tspan>)</text></g><g transform="matrix(1,0,0,1,665.909,-432.394)"><text x="-54.205px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">7<tspan x="-48.533px -44.901px " y="867.429px 867.429px ">. </tspan>Obtains attestation report, including the</text><g transform="matrix(12,0,0,12,154.031,879.429)"></g><text x="-38.156px" y="879.429px" style="font-family:'Tahoma';font-size:12px;">nonce and svsm_pk in the user data</text></g><rect x="619.865" y="746.553" width="208.886" height="22.6" style="fill:#ebebeb;"/><g transform="matrix(1,0,0,1,666.233,-106.394)"><text x="-42.96px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">15. state := AuthDec</text><text x="68.521px" y="870.429px" style="font-family:'Tahoma';font-size:10px;">state_key</text><g transform="matrix(12,0,0,12,158.834,867.429)"></g><text x="110.782px" y="867.429px" style="font-family:'Tahoma';font-size:12px;">(e_state)</text></g><use xlink:href="#_Image7" x="151.734" y="741.62" width="26px" height="11px"/><g transform="matrix(12,0,0,12,262.207,752.003)"></g><text x="183.926px" y="752.003px" style="font-family:'Tahoma';font-size:12px;">HT<tspan x="198.452px 205.459px " y="752.003px 752.003px ">TP</tspan> over TLS</text><use xlink:href="#_Image8" x="151.734" y="759.62" width="26px" height="11px"/><g transform="matrix(12,0,0,12,247.008,770.003)"></g><text x="183.926px" y="770.003px" style="font-family:'Tahoma';font-size:12px;">Serial/vsock</text><use xlink:href="#_Image9" x="151.734" y="776.62" width="26px" height="11px"/><g transform="matrix(12,0,0,12,255.387,787.003)"></g><text x="183.926px" y="787.003px" style="font-family:'Tahoma';font-size:12px;">Misc. comms.</text><defs><image id="_Image1" width="5px" height="754px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAALyCAYAAAASZx5tAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAk0lEQVRoge3IsQnDMBgF4ad0RqoN3jXg2j+aMwvEtS+N02WBwF1z8AVYgCfwur8EOOacbNvGnBPgCPAeY5CEMQbAuwG01vINyCM/EkVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVR/G88e+9JkvtngKoq1nWlqgAqQAf267oAdqB/AO0mVyxkvi1RAAAAAElFTkSuQmCC"/><image id="_Image2" width="282px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAALCAYAAACgTkIwAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA9klEQVRoge3asU3EMBgF4Pej28AScpkFIjHCZQkXdCnvlkDeAJqjS8kazg7poIgXyAyPAoLQoSM6kBIlel9p/8WrnqxfBiaQDCQTyTA1KyJylbFg+r5n0zQkmZbOJCLrtDs/+Hy5HHLO+5QScs7j1X7GXCKyIV9F80vB4NsMZ8wmIuv2BuBkZo9G8hbAQ875eKlgRESu5ZxDCAHe+7sdgENK6di27dK5RGRDhmFA13Xw3t/fAHiuqupU1zWKolg6m4hshHMOZVkCwIuNh1M7mhjjrCFFZPVe8bGjebLzm0uFE2OEmf2YFxH5M/2jEZHZ6GewiPzXO79Hjb9dSf2lAAAAAElFTkSuQmCC"/><image id="_Image3" width="282px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAALCAYAAACgTkIwAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABEElEQVRoge3aMUtCURjG8eeEIGJIEEQQ0hDSaEFTk0ujq0Nrk/YhGvoCBWKTjn2JBqe7dmetLYKELgTdhqbXwa6EYRcL7uVe/r/xnHd4pofDy5FimFnLzIZm1oqbBYCVRAVz//pu596jmdkw7UwAsqmwePD1cmn7QdjojybygzC6aiQZDEB+zIvml4LRtxlLMhyATHuQ1HPOXTkz25J04QdhZ1nBAMCqquWiLo92VauUDgqS2v3RS2cwnqSdC0COPH186u75TbVK6XRN0s3Z/nave7ynw831tLMByIlquaiTnQ1JunXRYdyOxmvWk00JIOvGmu1ort3izbLC8Zp1Oed+zAPAn/GPBkBi+BkM4L+mk2iOmntMe64AAAAASUVORK5CYII="/><image id="_Image4" width="282px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAALCAYAAACgTkIwAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABG0lEQVRoge3asUrDYBQF4HPLT4gg3eV/AfcggZK36Cj0AQzOgjgIDl2ypEKfwLlbsmYLBFwyBH0C9ySD0AzXQXEQtCRDg+F8cIe7nekMlwsQEQ2gqktV3ajq+dhZiGiCVHVZVZUmSaJ1XeuhwpkdMxwRTYbbdR2KokAcx0jT9LppmpffCkdU9QTAPYArAKfHTktE/1NZltjtdt+7MQae5yEIAszn80cAWxF5BT6L5i7P84csy7Df78fKTEQT8aNw1iJyK6r6FkXRWdu2Y+cjoglxXRer1QrW2osZgO1isYDjOGPnIqIJMMbA932EYQhr7VpEnnmjIaJB+txojIi8A7j5GiKig1T1EsAT8HfBEBEN1vePhohokD6fwR9Qjo97Nxx56AAAAABJRU5ErkJggg=="/><image id="_Image5" width="303px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAS8AAAALCAYAAAAulAtMAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABDklEQVRoge3aMUrEUBSF4XMnNsJrA7EJBKwCsZ/aFbgKxTVYCO5BxD3MLkKQlEkppEghTNoUIUVyLGRExAmmmaQ4X/e6vzrF5QEiIitA8prkjuQNSVu6R0TkX0juiqLgfr/nOI4keTs1YptTxomITLhq2xZlWSLPczRN80JyPDZiRvIcwCOAewDu1LUiIgdZlqHruu+3cw5RFMH3fZjZHYBXMyPwNV4PdV0/VVWFYRiWahYROerXiG3N7M1IfqRpetH3/dJ9IiKTgiBAHMcws7MNgOcwDOF53tJdIiJ/cs4hSZLDcG3NbNDNS0RWY9bNa6lIEZGfSL5nWXbZdd3kaImIrMrcf14iIqsw94f9Jx5Dmc3/IFBlAAAAAElFTkSuQmCC"/><image id="_Image6" width="282px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAALCAYAAACgTkIwAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABLUlEQVRoge3azyvDcRwG8Of95Vvb2mHFlJMsxf4AJRf+Ag7jIP4C5R+Qgzjshqjd3JSLkxxI/AXKRCYlxSyZX7etjT0OykHJvl+15dvzun1uz+k5PJ83ICLiA8kUyVWSfc3OIiIBRDJ1WHjl0mmeD6UKfyscp5HhRCQwQpX3GrauHzF+kMPy2d1MsVzN/VQ4RjIMYB7ANIBoo9OKyP+0l3/BwvHN19t1DKNdbZjq6UA85K4ByJjZBfBZNHObV8XF9ct7lN5qzcosIgHxrXDSZjZrJAsj++edT+Vqs/OJSIBE3RasDCSQjEX6HQCZiUQc4VbNNSLyd65jGOtux8ZwL5KxSNrMjrTRiIgvXjYaERHPSE7u3j5zcDvLoZ2Tur+5RUTq5vWORkTEFy+XwR9ntaDB9z3GDwAAAABJRU5ErkJggg=="/><image id="_Image7" width="26px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAALCAYAAABhwJ3wAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABLUlEQVQ4jbWUP0/CUBTFzw3WRNMJKYOJiaC7OxNfwE0a/AjqKomBGFzECSdNXMABB8OXYGK1oyk2rlK0Lu0kmuOEKbXpa/xztvfOzf3dm/vuAxQiaZIckDQj9zrJGsljkiuqPErA3YvPg6FDkoOIX7t5cNm1x/Tf3knyNAm4EAcAsGd5Qblju7C8YGaVI6FZf/qBnjPB7eMzqkWjXink6iRbAM5FxAsHSwoAAGC4vfWtyqv7J/ScyddZ1zKoFg1UCjnoWmYOKCTzAJqWF+zHAX6iCPBQRNpCstmxxyfdkftrQFSry4u4LG0iv6St/VtHuxsGdtZDHc3Mv5pRCNAC0BaRVyD06kSkD6BP0rwo6bFAEQkXdgbgSAVQKu0eXY/m9iibKnkSMOFnaKQBfAJek/tq0eAR7gAAAABJRU5ErkJggg=="/><image id="_Image8" width="26px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAALCAYAAABhwJ3wAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGUlEQVQ4jbWUsWqEQBRF74M0A2lcIV1Kf0NXP8J/SAqrLIQNYdNkU21AP2NbwRGm8D/UX0hKp7yplohxnQ0ht5w73PMeb94ADpFMSTYk08n5NckNyWeSvivHCWjblnmek2Qz8TfGGGqtOQwDSb4uAa/mAADuuq5ba63R9/3JWk+urqy1MMagaRrEcbyNomhLcg/gXUQ+ZkELgHERnKvWWouqqhaBQvIGwK7ruvtzgN9KKYU4jhFFEZRSDyJyEJI7rfWL1vrPgKl830eWZfA87/bfOkqSBGEYfnd0Ml0zKoriR2BZljDGnAPsARxE5BMYPQYROQI4kkyDIJgFisi4sDcAjy6AU5fuUV3X4z1aXRS+BFz4GZ4uAXwB8wIBrSluIDQAAAAASUVORK5CYII="/><image id="_Image9" width="26px" height="11px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAALCAYAAABhwJ3wAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABDElEQVQ4jbXUP0rEQBQG8O/BFAnYzArbzRQ5Qk6wkDvkDlq7ICuyNmq1tt5hL7EnyBEyGYKtmQMk8FmJMYYkrOwr5z3e7w3zB5gJkjnJE8l8sH5FckvykeT1XJ9ZoGkaFkVBkqdBfuu9p3OObduS5PMUqMYAADchhE1VVQghfKc2g9JV13Xw3qOua1hrd8aYHckXAG8i8tkvlgUAACDLsj9TlmUJ7/3P1ErBWgtjDJRSv0AhuQawDyHcjgHnxAC8E5GDkNw7556qqvo3MIw4jpGmKaIoMgrAe5Ika631JXf0cekzOohIA/RunYgcARxJ5lrrUVBE+oO9ArifA2bjzHe0WtR8Cpz4GR6WAF+29/htBjN2UwAAAABJRU5ErkJggg=="/></defs></svg>